<div *ngIf="borderColor != null" class="card_indicator"></div>

<i
    *ngIf="isCollapseHandler"
    nz-icon
    nzType="picto:angle-down"
    class="card_collapse"
    [class.rotate270]="collapsed"
    (click)="this.collapsed = !this.collapsed"
></i>

<ng-container *ngIf="hasCellActions && !isDisplayTabular">
    <ng-container *ngTemplateOutlet="actionsButtonTpl"></ng-container>
</ng-container>

<a
    *ngIf="redirectTo; else noLinkTpl"
    [routerLink]="redirectTo.path"
    [queryParams]="redirectTo.queryParams"
    class="card_content"
>
    <ng-container *ngTemplateOutlet="contentTpl"></ng-container>
</a>

<ng-template #noLinkTpl>
    <div class="card_content">
        <ng-container *ngTemplateOutlet="contentTpl"></ng-container>
    </div>
</ng-template>

<ng-content></ng-content>

<div *ngIf="footer?.template" class="card_footer">
    <ng-container *ngTemplateOutlet="footer.template"></ng-container>
</div>

<ng-template #contentTpl>
    <!-- on ne progète ici que les cardCell pour éviter de casser le css -->
    <ng-content select="app-card-cell"></ng-content>

    <app-card-cell *ngIf="hasCellActions && isDisplayTabular">
        <ng-container *ngTemplateOutlet="actionsButtonTpl"></ng-container>
    </app-card-cell>
</ng-template>

<ng-template #actionsButtonTpl>
    <!-- La cellule des actions peut-être affichée mais vide si dans une liste
         il y a un mélange des cartes avec actions et sans 
         afin de conserver l'alignement dans la liste -->
    <div
        *ngIf="actions || actionsTpl"
        class="card_actions"
        (click)="$event.stopPropagation()"
    >
        <ng-container *ngIf="actionsTpl; else defaultActionsTpl">
            <ng-container *ngTemplateOutlet="actionsTpl"></ng-container>
        </ng-container>
        <ng-template #defaultActionsTpl>
            <i
                nz-icon
                nzType="picto:more"
                nz-dropdown
                [nzDropdownMenu]="actions"
                nzTrigger="click"
                nzPlacement="bottomRight"
            ></i>
        </ng-template>
    </div>
</ng-template>
